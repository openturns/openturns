-- SVD square case ------------------------------------------
matrix1= [[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
svd (svd only)= class=Point name=Unnamed dimension=3 values=[30.0404,1.87808,0.212697]
svd (svd + u, vT full)= class=Point name=Unnamed dimension=3 values=[30.0404,1.87808,0.212697]
svd (svd + u, vT small)= class=Point name=Unnamed dimension=3 values=[30.0404,1.87808,0.212697]
u= [[ -0.0459872 -0.548195  -0.835085  ]
 [ -0.301051  -0.789498   0.534847  ]
 [ -0.952499   0.275999  -0.128728  ]]
vT= [[ -0.116696 -0.326982 -0.937798 ]
 [ -0.691768 -0.650768  0.312984 ]
 [ -0.712629  0.685262 -0.150254 ]]

-- SVD rectangular case, m < n ------------------------------
matrix1= 3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
svd (svd only)= class=Point name=Unnamed dimension=3 values=[260.274,7.40515,0.848945]
svd (svd + u, vT full)= class=Point name=Unnamed dimension=3 values=[260.274,7.40515,0.848945]
svd (svd + u, vT small)= class=Point name=Unnamed dimension=3 values=[260.274,7.40515,0.848945]
u= [[ -0.00543408 -0.205213   -0.978702   ]
 [ -0.139192   -0.969034    0.203958   ]
 [ -0.99025     0.137336   -0.0232982  ]]
vT= 3x5
[[ -0.0125044 -0.0364019 -0.107025  -0.316754  -0.941664  ]
 [ -0.233793  -0.384235  -0.573844  -0.619233   0.291474  ]
 [ -0.754678  -0.438843   0.0281659  0.468196  -0.133706  ]]

-- SVD rectangular case, m > n ------------------------------
matrix1= 5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
svd (svd only)= class=Point name=Unnamed dimension=3 values=[146.689,5.57511,0.603932]
svd (svd + u, vT full)= class=Point name=Unnamed dimension=3 values=[146.689,5.57511,0.603932]
svd (svd + u, vT small)= class=Point name=Unnamed dimension=3 values=[146.689,5.57511,0.603932]
u= 5x3
[[ -0.0084125  0.203498   0.721867  ]
 [ -0.0596376  0.487761   0.453866  ]
 [ -0.193613   0.631308  -0.152421  ]
 [ -0.450275   0.412659  -0.445414  ]
 [ -0.869563  -0.389667   0.226469  ]]
vT= [[ -0.0467483 -0.210875  -0.976395  ]
 [  0.497792   0.842527  -0.205796  ]
 [  0.866036  -0.495662   0.0655852 ]]

-- QR square case ------------------------------------------
M= [[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
full= false
keep= false
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=[[  -3.74166  -9.6214  -26.1916  ]
 [   0         2.32993  10.3007  ]
 [   0         0        -1.37649 ]]
QR=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
-- QR rectangular case, m < n-------------------------------
M= 3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
full= false
keep= false
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=3x5
[[   -3.74166   -9.6214   -26.1916   -73.7641  -212.205   ]
 [    0          2.32993   10.3007    36.1752   117.723   ]
 [    0          0         -1.37649   -8.25897  -34.4124  ]]
QR=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
-- QR rectangular case, m > n-------------------------------
M= 5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
full= false
keep= false
Q= 5x3
[[ -0.13484   -0.403961   0.61742   ]
 [ -0.26968   -0.546536   0.275741  ]
 [ -0.40452   -0.427724  -0.335685  ]
 [ -0.53936   -0.0475248 -0.527504  ]
 [ -0.6742     0.594061   0.389634  ]]
R=[[   -7.4162   -30.339   -132.008   ]
 [    0          7.6515    54.8912  ]
 [    0          0          8.70382 ]]
QR=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
-- QR square case ------------------------------------------
M= [[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
full= false
keep= true
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=[[  -3.74166  -9.6214  -26.1916  ]
 [   0         2.32993  10.3007  ]
 [   0         0        -1.37649 ]]
QR=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
M2=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
-- QR rectangular case, m < n-------------------------------
M= 3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
full= false
keep= true
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=3x5
[[   -3.74166   -9.6214   -26.1916   -73.7641  -212.205   ]
 [    0          2.32993   10.3007    36.1752   117.723   ]
 [    0          0         -1.37649   -8.25897  -34.4124  ]]
QR=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
M2=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
-- QR rectangular case, m > n-------------------------------
M= 5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
full= false
keep= true
Q= 5x3
[[ -0.13484   -0.403961   0.61742   ]
 [ -0.26968   -0.546536   0.275741  ]
 [ -0.40452   -0.427724  -0.335685  ]
 [ -0.53936   -0.0475248 -0.527504  ]
 [ -0.6742     0.594061   0.389634  ]]
R=[[   -7.4162   -30.339   -132.008   ]
 [    0          7.6515    54.8912  ]
 [    0          0          8.70382 ]]
QR=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
M2=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
-- QR square case ------------------------------------------
M= [[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
full= true
keep= false
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=[[  -3.74166  -9.6214  -26.1916  ]
 [   0         2.32993  10.3007  ]
 [   0         0        -1.37649 ]]
QR=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
-- QR rectangular case, m < n-------------------------------
M= 3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
full= true
keep= false
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=3x5
[[   -3.74166   -9.6214   -26.1916   -73.7641  -212.205   ]
 [    0          2.32993   10.3007    36.1752   117.723   ]
 [    0          0         -1.37649   -8.25897  -34.4124  ]]
QR=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
-- QR rectangular case, m > n-------------------------------
M= 5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
full= true
keep= false
Q= 5x5
[[ -0.13484   -0.403961   0.61742    0.0097831 -0.66131   ]
 [ -0.26968   -0.546536   0.275741   0.35776    0.651572  ]
 [ -0.40452   -0.427724  -0.335685  -0.735087   0.0194756 ]
 [ -0.53936   -0.0475248 -0.527504   0.556207  -0.345262  ]
 [ -0.6742     0.594061   0.389634  -0.148974   0.136157  ]]
R=5x3
[[   -7.4162   -30.339   -132.008   ]
 [    0          7.6515    54.8912  ]
 [    0          0          8.70382 ]
 [    0          0          0       ]
 [    0          0          0       ]]
QR=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
-- QR square case ------------------------------------------
M= [[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
full= true
keep= true
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=[[  -3.74166  -9.6214  -26.1916  ]
 [   0         2.32993  10.3007  ]
 [   0         0        -1.37649 ]]
QR=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
M2=[[  1  1  1 ]
 [  2  4  8 ]
 [  3  9 27 ]]
-- QR rectangular case, m < n-------------------------------
M= 3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
full= true
keep= true
Q= [[ -0.267261 -0.674453 -0.688247 ]
 [ -0.534522 -0.490511  0.688247 ]
 [ -0.801784  0.551825 -0.229416 ]]
R=3x5
[[   -3.74166   -9.6214   -26.1916   -73.7641  -212.205   ]
 [    0          2.32993   10.3007    36.1752   117.723   ]
 [    0          0         -1.37649   -8.25897  -34.4124  ]]
QR=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
M2=3x5
[[   1   1   1   1   1 ]
 [   2   4   8  16  32 ]
 [   3   9  27  81 243 ]]
-- QR rectangular case, m > n-------------------------------
M= 5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
full= true
keep= true
Q= 5x5
[[ -0.13484   -0.403961   0.61742    0.0097831 -0.66131   ]
 [ -0.26968   -0.546536   0.275741   0.35776    0.651572  ]
 [ -0.40452   -0.427724  -0.335685  -0.735087   0.0194756 ]
 [ -0.53936   -0.0475248 -0.527504   0.556207  -0.345262  ]
 [ -0.6742     0.594061   0.389634  -0.148974   0.136157  ]]
R=5x3
[[   -7.4162   -30.339   -132.008   ]
 [    0          7.6515    54.8912  ]
 [    0          0          8.70382 ]
 [    0          0          0       ]
 [    0          0          0       ]]
QR=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
M2=5x3
[[   1   1   1 ]
 [   2   4   8 ]
 [   3   9  27 ]
 [   4  16  64 ]
 [   5  25 125 ]]
